{{define "integrations/configure.html"}}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - ë°±ì˜¤í”¼ìŠ¤</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        .integration-header-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .integration-header-icon {
            font-size: 64px;
            background: white;
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
        }

        .integration-header-info h1 {
            margin: 0 0 10px 0;
            font-size: 32px;
        }

        .integration-header-info p {
            margin: 0;
            opacity: 0.9;
            font-size: 16px;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            margin-top: 10px;
        }

        .status-badge.connected {
            background: #4caf50;
            color: white;
        }

        .status-badge.disconnected {
            background: rgba(255, 255, 255, 0.3);
            color: white;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 16px;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .info-box-title {
            font-weight: 600;
            color: #1976d2;
            margin-bottom: 8px;
        }

        .info-box-content {
            color: #424242;
            font-size: 14px;
            line-height: 1.6;
        }

        .config-section {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .config-section-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f5f5f5;
        }

        .credential-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .credential-label {
            min-width: 120px;
            font-weight: 500;
            color: #666;
        }

        .credential-value {
            flex: 1;
            padding: 8px 12px;
            background: #f5f5f5;
            border-radius: 4px;
            font-family: monospace;
            font-size: 13px;
            color: #333;
        }

        .test-result {
            margin-top: 20px;
            padding: 16px;
            border-radius: 8px;
            display: none;
        }

        .test-result.success {
            background: #e8f5e9;
            border: 1px solid #4caf50;
            color: #2e7d32;
        }

        .test-result.error {
            background: #ffebee;
            border: 1px solid #f44336;
            color: #c62828;
        }

        .step-guide {
            counter-reset: step;
        }

        .step-item {
            position: relative;
            padding-left: 50px;
            margin-bottom: 20px;
        }

        .step-item::before {
            counter-increment: step;
            content: counter(step);
            position: absolute;
            left: 0;
            top: 0;
            width: 32px;
            height: 32px;
            background: #2196f3;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .step-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .step-content {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }

        .code-block {
            background: #263238;
            color: #aed581;
            padding: 12px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 13px;
            margin: 10px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    {{template "sidebar" .}}
    
    <div class="main-wrapper">
        {{template "header" .}}
        
        <main class="content">
<!-- ì•¡ì…˜ ë²„íŠ¼ -->
<div class="detail-actions">
    <a href="/integrations" class="btn-back">â† ì—°ë™ ê´€ë¦¬ë¡œ</a>
</div>

<!-- ì—°ë™ í—¤ë” -->
<div class="integration-header-card">
    <div class="integration-header-icon">
        {{.Service.Icon}}
    </div>
    <div class="integration-header-info">
        <h1>{{.Service.Name}}</h1>
        <p>{{.Service.Description}}</p>
        <span class="status-badge {{if .Service.Connected}}connected{{else}}disconnected{{end}}">
            {{if .Service.Connected}}âœ“ ì—°ë™ë¨{{else}}â—‹ ì—°ë™ ì•ˆë¨{{end}}
        </span>
    </div>
</div>

<!-- ì•ˆë‚´ ì •ë³´ -->
<div class="info-box">
    <div class="info-box-title">ğŸ“Œ ì—°ë™ ì „ ì¤€ë¹„ì‚¬í•­</div>
    <div class="info-box-content">
        Gmail APIë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ Google Cloud Consoleì—ì„œ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ê³  Gmail APIë¥¼ í™œì„±í™”í•´ì•¼ í•©ë‹ˆë‹¤.
        OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ IDë¥¼ ìƒì„±í•œ í›„ ì•„ë˜ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
    </div>
</div>

<!-- í˜„ì¬ ì—°ë™ ì •ë³´ -->
{{if .Service.Connected}}
<div class="config-section">
    <div class="config-section-title">ğŸ”— í˜„ì¬ ì—°ë™ ì •ë³´</div>
    <div class="credential-item">
        <span class="credential-label">Client ID</span>
        <span class="credential-value">1234567890-abcdefghijklmnopqrstuvwxyz.apps.googleusercontent.com</span>
    </div>
    <div class="credential-item">
        <span class="credential-label">ì—°ë™ ì´ë©”ì¼</span>
        <span class="credential-value">admin@company.com</span>
    </div>
    <div class="credential-item">
        <span class="credential-label">ë§ˆì§€ë§‰ ë™ê¸°í™”</span>
        <span class="credential-value">2024-01-15 14:30:22</span>
    </div>
    <div style="margin-top: 20px; display: flex; gap: 10px;">
        <button class="btn-primary" onclick="testConnection()">ğŸ” ì—°ê²° í…ŒìŠ¤íŠ¸</button>
        <button class="btn-secondary" onclick="syncNow()">ğŸ”„ ì§€ê¸ˆ ë™ê¸°í™”</button>
    </div>
    <div id="testResult" class="test-result"></div>
</div>
{{end}}

<!-- ì—°ë™ ì„¤ì • í¼ -->
<div class="config-section">
    <div class="config-section-title">âš™ï¸ ì—°ë™ ì„¤ì •</div>
    
    <div class="form-body">
        <div class="form-row">
            <label class="form-label">Client ID <span class="required">*</span></label>
            <input type="text" class="form-input" placeholder="Google OAuth Client IDë¥¼ ì…ë ¥í•˜ì„¸ìš”" 
                   value="{{if .Service.Connected}}1234567890-abcdefghijklmnopqrstuvwxyz.apps.googleusercontent.com{{end}}">
            <small class="form-hint">Google Cloud Consoleì—ì„œ ë°œê¸‰ë°›ì€ OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID</small>
        </div>

        <div class="form-row">
            <label class="form-label">Client Secret <span class="required">*</span></label>
            <input type="password" class="form-input" placeholder="Client Secretì„ ì…ë ¥í•˜ì„¸ìš”">
            <small class="form-hint">í´ë¼ì´ì–¸íŠ¸ IDì™€ í•¨ê»˜ ë°œê¸‰ëœ ë¹„ë°€ í‚¤</small>
        </div>

        <div class="form-row">
            <label class="form-label">Redirect URI <span class="required">*</span></label>
            <input type="text" class="form-input" placeholder="https://your-domain.com/auth/gmail/callback" 
                   value="{{if .Service.Connected}}https://backoffice.company.com/auth/gmail/callback{{end}}">
            <small class="form-hint">OAuth ì¸ì¦ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸ë  URL (Google Cloud Consoleì— ë“±ë¡ í•„ìš”)</small>
        </div>

        <div class="form-row">
            <label class="form-label">ë°œì‹ ì ì´ë©”ì¼ <span class="required">*</span></label>
            <input type="email" class="form-input" placeholder="sender@company.com" 
                   value="{{if .Service.Connected}}admin@company.com{{end}}">
            <small class="form-hint">ì´ë©”ì¼ ë°œì†¡ ì‹œ ì‚¬ìš©ë  ë°œì‹ ì ì£¼ì†Œ</small>
        </div>

        <div class="form-row">
            <label class="form-label">ë°œì‹ ì ì´ë¦„</label>
            <input type="text" class="form-input" placeholder="íšŒì‚¬ëª… ë˜ëŠ” ì„œë¹„ìŠ¤ëª…" 
                   value="{{if .Service.Connected}}ë°±ì˜¤í”¼ìŠ¤ ì‹œìŠ¤í…œ{{end}}">
        </div>
    </div>
</div>

<!-- ì„¤ì • ê°€ì´ë“œ -->
<div class="config-section">
    <div class="config-section-title">ğŸ“– ì—°ë™ ê°€ì´ë“œ</div>
    
    <div class="step-guide">
        <div class="step-item">
            <div class="step-title">Google Cloud Console ì ‘ì†</div>
            <div class="step-content">
                <a href="https://console.cloud.google.com" target="_blank">https://console.cloud.google.com</a>ì— ì ‘ì†í•˜ì—¬ ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ê¸°ì¡´ í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
            </div>
        </div>

        <div class="step-item">
            <div class="step-title">Gmail API í™œì„±í™”</div>
            <div class="step-content">
                "API ë° ì„œë¹„ìŠ¤" â†’ "ë¼ì´ë¸ŒëŸ¬ë¦¬"ì—ì„œ "Gmail API"ë¥¼ ê²€ìƒ‰í•˜ê³  í™œì„±í™”í•©ë‹ˆë‹¤.
            </div>
        </div>

        <div class="step-item">
            <div class="step-title">OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID ìƒì„±</div>
            <div class="step-content">
                "API ë° ì„œë¹„ìŠ¤" â†’ "ì‚¬ìš©ì ì¸ì¦ ì •ë³´" â†’ "ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ë§Œë“¤ê¸°" â†’ "OAuth í´ë¼ì´ì–¸íŠ¸ ID"ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
                ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ í˜•ì€ "ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜"ì„ ì„ íƒí•©ë‹ˆë‹¤.
            </div>
        </div>

        <div class="step-item">
            <div class="step-title">ë¦¬ë””ë ‰ì…˜ URI ì„¤ì •</div>
            <div class="step-content">
                ìŠ¹ì¸ëœ ë¦¬ë””ë ‰ì…˜ URIì— ì•„ë˜ ì£¼ì†Œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤:
                <div class="code-block">https://your-domain.com/auth/gmail/callback</div>
            </div>
        </div>

        <div class="step-item">
            <div class="step-title">ì¸ì¦ ì •ë³´ ì…ë ¥</div>
            <div class="step-content">
                ë°œê¸‰ë°›ì€ Client IDì™€ Client Secretì„ ìœ„ í¼ì— ì…ë ¥í•˜ê³  ì €ì¥í•©ë‹ˆë‹¤.
            </div>
        </div>
    </div>
</div>

<!-- ì €ì¥ ë²„íŠ¼ -->
<div class="form-actions">
    <button class="btn-primary-large" onclick="saveConfiguration()">ğŸ’¾ ì €ì¥ ë° ì—°ë™</button>
    {{if .Service.Connected}}
    <button class="btn-secondary-large" onclick="disconnectService()">ğŸ”Œ ì—°ë™ í•´ì œ</button>
    {{else}}
    <a href="/integrations" class="btn-secondary-large">ì·¨ì†Œ</a>
    {{end}}
</div>

<script>
    function saveConfiguration() {
        // TODO: ì‹¤ì œ API í˜¸ì¶œë¡œ ì„¤ì • ì €ì¥
        alert('ì—°ë™ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
        window.location.href = '/integrations';
    }

    function testConnection() {
        const resultDiv = document.getElementById('testResult');
        resultDiv.style.display = 'block';
        resultDiv.className = 'test-result';
        resultDiv.innerHTML = 'ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...';

        // TODO: ì‹¤ì œ ì—°ê²° í…ŒìŠ¤íŠ¸ API í˜¸ì¶œ
        setTimeout(() => {
            resultDiv.className = 'test-result success';
            resultDiv.innerHTML = 'âœ“ ì—°ê²° ì„±ê³µ! Gmail APIì™€ ì •ìƒì ìœ¼ë¡œ í†µì‹ í•˜ê³  ìˆìŠµë‹ˆë‹¤.';
        }, 1500);
    }

    function syncNow() {
        if (confirm('ì§€ê¸ˆ Gmailê³¼ ë™ê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            alert('ë™ê¸°í™”ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.');
            // TODO: ì‹¤ì œ ë™ê¸°í™” API í˜¸ì¶œ
        }
    }

    function disconnectService() {
        if (confirm('Gmail ì—°ë™ì„ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì—°ë™ í•´ì œ ì‹œ ì´ë©”ì¼ ë°œì†¡ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
            // TODO: ì‹¤ì œ ì—°ë™ í•´ì œ API í˜¸ì¶œ
            alert('ì—°ë™ì´ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            window.location.href = '/integrations';
        }
    }
</script>
        </main>
    </div>
</body>
</html>
{{end}}
