{{define "customers/add.html"}}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - ë°±ì˜¤í”¼ìŠ¤</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="/static/js/modal-utils.js"></script>
</head>
<body>
    {{template "sidebar" .}}
    
    <div class="main-wrapper">
        {{template "header" .}}
        
        <main class="content">
<!-- ì•¡ì…˜ ë²„íŠ¼ -->
<div class="detail-actions">
    <a href="/customers" class="btn-back">â† ëª©ë¡ìœ¼ë¡œ</a>
</div>

<!-- ê³ ê° ì¶”ê°€ í¼ -->
<div class="content-card">
    <div class="form-header">
        <h2>ê¸°ë³¸ ì •ë³´</h2>
    </div>
    <form method="POST" action="/customers/add">
        <div class="form-body">
            <div class="form-row">
                <label class="form-label">ì´ë¦„ <span class="required">*</span></label>
                <input type="text" name="name" class="form-input" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required>
            </div>
            <div class="form-row">
                <label class="form-label">ì „í™”ë²ˆí˜¸ <span class="required">*</span></label>
                <input type="tel" id="phoneNumber" name="phone_number" class="form-input" placeholder="01012345678" pattern="^010[0-9]{8}$" maxlength="11" required>
                <small style="color: #666; font-size: 0.85rem; margin-top: 0.25rem; display: block;">í•˜ì´í”ˆ ì—†ì´ ìˆ«ìë§Œ ì…ë ¥í•´ì£¼ì„¸ìš” (ì˜ˆ: 01012345678)</small>
            </div>
            <div class="form-row">
                <label class="form-label">ì½”ë©˜íŠ¸</label>
                <textarea name="comment" class="form-textarea" rows="4" placeholder="ê³ ê°ì— ëŒ€í•œ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)" maxlength="200"></textarea>
                <small style="color: #666; font-size: 0.85rem; margin-top: 0.25rem; display: block;">ìµœëŒ€ 200ìê¹Œì§€ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.</small>
            </div>
        </div>

        <!-- ì €ì¥ ë²„íŠ¼ -->
        <div class="form-actions">
            <button type="submit" class="btn-primary-large">ğŸ’¾ ì €ì¥</button>
            <a href="/customers" class="btn-secondary-large">ì·¨ì†Œ</a>
        </div>
    </form>
</div>
        </main>
    </div>

<style>
.caller-btn {
    width: 28px;
    height: 28px;
    padding: 0;
    border: 1px solid #ddd;
    background: white;
    color: #333;
    font-size: 11px;
    font-weight: 600;
    border-radius: 3px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.caller-btn:hover {
    background: #f0f0f0;
    border-color: #4a90e2;
}

.caller-btn.selected {
    background: #4a90e2;
    color: white;
    border-color: #4a90e2;
}
</style>

<script>
// ì „í™”ë²ˆí˜¸ ì…ë ¥ ê²€ì¦
const phoneInput = document.getElementById('phoneNumber');
if (phoneInput) {
    phoneInput.addEventListener('input', function(e) {
        // ìˆ«ìë§Œ ë‚¨ê¸°ê¸°
        let value = e.target.value.replace(/[^0-9]/g, '');
        
        // 11ìë¦¬ ì œí•œ
        if (value.length > 11) {
            value = value.slice(0, 11);
        }
        
        e.target.value = value;
    });
    
    phoneInput.addEventListener('blur', function(e) {
        const value = e.target.value;
        // 010ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” 11ìë¦¬ ìˆ«ìì¸ì§€ í™•ì¸
        if (value && !/^010[0-9]{8}$/.test(value)) {
            alert('ì „í™”ë²ˆí˜¸ëŠ” 010ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” 11ìë¦¬ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.');
            // focus()ë¥¼ í˜¸ì¶œí•˜ë©´ ë¬´í•œ ë£¨í”„ê°€ ë°œìƒí•˜ë¯€ë¡œ ì œê±°
        }
    });
}

// URL íŒŒë¼ë¯¸í„°ë¡œ ì„±ê³µ/ì‹¤íŒ¨ ë©”ì‹œì§€ í™•ì¸
window.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const success = urlParams.get('success');
    const error = urlParams.get('error');
    
    if (success === 'add') {
        const modalId = 'success-modal-' + Date.now();
        ModalManager.createAlert({
            id: modalId,
            title: 'ì¶”ê°€ ì™„ë£Œ',
            message: 'âœ… ìƒˆ ê³ ê°ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.',
            confirmText: 'í™•ì¸',
            onConfirm: () => {
                window.location.href = '/customers';
            }
        });
        ModalManager.show(modalId);
        
        // URLì—ì„œ íŒŒë¼ë¯¸í„° ì œê±°
        window.history.replaceState({}, document.title, window.location.pathname);
    } else if (error === 'add') {
        const modalId = 'error-modal-' + Date.now();
        ModalManager.createAlert({
            id: modalId,
            title: 'ì¶”ê°€ ì‹¤íŒ¨',
            message: 'âŒ ê³ ê° ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',
            confirmText: 'í™•ì¸'
        });
        ModalManager.show(modalId);
        
        // URLì—ì„œ íŒŒë¼ë¯¸í„° ì œê±°
        window.history.replaceState({}, document.title, window.location.pathname);
    } else if (error === 'invalid_phone') {
        const modalId = 'error-modal-' + Date.now();
        ModalManager.createAlert({
            id: modalId,
            title: 'ì…ë ¥ ì˜¤ë¥˜',
            message: 'âŒ ì „í™”ë²ˆí˜¸ëŠ” 010ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” 11ìë¦¬ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.',
            confirmText: 'í™•ì¸'
        });
        ModalManager.show(modalId);
        
        // URLì—ì„œ íŒŒë¼ë¯¸í„° ì œê±°
        window.history.replaceState({}, document.title, window.location.pathname);
    }
});
</script>

</body>
</html>
{{end}}
