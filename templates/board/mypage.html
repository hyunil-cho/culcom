{{define "board/mypage.html"}}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ˆì´í˜ì´ì§€ - CulCom</title>
    <link rel="stylesheet" href="/static/css/board.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+KR:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

<!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
<nav class="board-nav">
    <div class="board-container nav-inner">
        <a href="/" class="board-logo">
            <span class="logo-icon">ğŸ“¢</span>
            <span class="logo-text">CulCom</span>
            <span class="logo-divider"></span>
            <span class="logo-sub">ê³µì§€ Â· ì´ë²¤íŠ¸</span>
        </a>
        <div class="nav-right">
            <a href="/board/mypage" class="nav-mypage-btn active">ë§ˆì´í˜ì´ì§€</a>
            <a href="/board/logout" class="nav-logout-btn">ë¡œê·¸ì•„ì›ƒ</a>
        </div>
    </div>
</nav>

<!-- ë©”ì¸ ì½˜í…ì¸  -->
<main class="board-main">
    <div class="board-container board-container-narrow">

        <h2 class="mypage-title">ë§ˆì´í˜ì´ì§€</h2>

        <!-- íšŒì› ì •ë³´ -->
        <div class="mypage-section">
            <h3 class="mypage-section-title">íšŒì› ì •ë³´</h3>
            <div class="mypage-info-card">
                <div class="info-row">
                    <span class="info-label">ì´ë¦„</span>
                    <span class="info-value">{{.MemberInfo.Name}}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">ì „í™”ë²ˆí˜¸</span>
                    <span class="info-value">{{if .MemberInfo.PhoneNumber}}{{.MemberInfo.PhoneNumber}}{{else}}ë¯¸ë“±ë¡{{end}}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">ê°€ì…ì¼</span>
                    <span class="info-value">{{.MemberInfo.CreatedDate}}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">ë¡œê·¸ì¸ ë°©ì‹</span>
                    <span class="info-value">
                        <span class="kakao-login-badge">ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸</span>
                    </span>
                </div>
            </div>
        </div>

        <!-- íšŒì›íƒˆí‡´ -->
        <div class="mypage-section mypage-danger-zone">
            <h3 class="mypage-section-title danger">íšŒì›íƒˆí‡´</h3>
            <div class="mypage-danger-card">
                <p class="danger-description">
                    íšŒì›íƒˆí‡´ ì‹œ ëª¨ë“  íšŒì› ì •ë³´ê°€ ì‚­ì œë˜ë©°, ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                </p>
                <button type="button" class="btn-withdraw" onclick="confirmWithdraw()">íšŒì›íƒˆí‡´</button>
            </div>
        </div>

    </div>
</main>

<!-- íšŒì›íƒˆí‡´ í™•ì¸ ëª¨ë‹¬ -->
<div class="modal-overlay" id="withdrawModal" style="display:none;">
    <div class="modal-box">
        <h3 class="modal-title">ì •ë§ íƒˆí‡´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</h3>
        <p class="modal-desc">íƒˆí‡´ í›„ì—ëŠ” ëª¨ë“  íšŒì› ì •ë³´ê°€ ì‚­ì œë˜ë©°,<br>ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
        <div class="modal-actions">
            <button type="button" class="btn-modal-cancel" onclick="closeWithdrawModal()">ì·¨ì†Œ</button>
            <button type="button" class="btn-modal-confirm" onclick="executeWithdraw()">íƒˆí‡´í•˜ê¸°</button>
        </div>
    </div>
</div>

<!-- í‘¸í„° -->
<footer class="board-footer">
    <div class="board-container">
        <p>&copy; 2026 CulCom. All rights reserved.</p>
    </div>
</footer>

<script>
function confirmWithdraw() {
    document.getElementById('withdrawModal').style.display = 'flex';
}

function closeWithdrawModal() {
    document.getElementById('withdrawModal').style.display = 'none';
}

function executeWithdraw() {
    fetch('/board/withdraw', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }
    })
    .then(resp => resp.json())
    .then(data => {
        if (data.success) {
            alert('íšŒì›íƒˆí‡´ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            window.location.href = '/';
        } else {
            alert(data.error || 'ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    })
    .catch(() => {
        alert('ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    });
}

// ëª¨ë‹¬ ë°”ê¹¥ í´ë¦­ ì‹œ ë‹«ê¸°
document.getElementById('withdrawModal').addEventListener('click', function(e) {
    if (e.target === this) closeWithdrawModal();
});
</script>

</body>
</html>
{{end}}
